total_diff <-   raw %>% filter(Emission_source=="Total")
View(total_diff)
total_diff <-   raw %>% filter(Emission_source=="Total") %>% select(mean_flat_difference)
View(total_diff)
total_diff <-   raw %>%
filter(Emission_source=="Total") %>%
select(mean_flat_difference) %>%
as.numeric()
percentage_diffs <- tibble(Emission_source=raw$Emission_source,
delta_percent=raw$mean_flat_difference/total_diff)
View(percentage_diffs)
ggplot(data=raw,
aes(x="",
y=mean_flat_difference,
fill=Emission_source))+
geom_col()+
coord_polar(theta="y")
ggplot(data=raw %>% filter(Emission_source!="Total"),
aes(x="",
y=mean_flat_difference,
fill=Emission_source))+
geom_col()+
coord_polar(theta="y")
ggplot(data=raw %>% filter(Emission_source!="Total"),
aes(x="",
y=fct_reorder(mean_flat_difference),
fill=Emission_source))+
geom_col()+
coord_polar(theta="y")
ggplot(data=raw %>% filter(Emission_source!="Total"),
aes(x="",
y=mean_flat_difference,
fill=fct_reorder(Emission_source)))+
geom_col()+
coord_polar(theta="y")
ggplot(data=raw %>% filter(Emission_source!="Total"),
aes(x="",
y=mean_flat_difference,
fill=fct_reorder(Emission_source,mean_flat_differnce)))+
geom_col()+
coord_polar(theta="y")
ggplot(data=raw %>% filter(Emission_source!="Total"),
aes(x="",
y=mean_flat_difference,
fill=fct_reorder(Emission_source,mean_flat_difference)))+
geom_col()+
coord_polar(theta="y")
ggplot(data=raw %>% filter(Emission_source!="Total"),
aes(x="",
y=mean_flat_difference,
fill=fct_reorder(Emission_source,mean_flat_difference)))+
geom_col()+
coord_polar(theta="y")+
scale_fill_viridis_d()
output <- ggplot(data=raw %>% filter(Emission_source!="Total"),
aes(x="",
y=mean_flat_difference,
fill=fct_reorder(Emission_source,mean_flat_difference)))+
geom_col()+
coord_polar(theta="y")+
scale_fill_viridis_d()+
labs(title = paste0("How each source of ",pollutant," contributes to the inequality gradient"))
pollutant <- PM2.5
pollutant <- "PM2.5"
output <- ggplot(data=raw %>% filter(Emission_source!="Total"),
aes(x="",
y=mean_flat_difference,
fill=fct_reorder(Emission_source,mean_flat_difference)))+
geom_col()+
coord_polar(theta="y")+
scale_fill_viridis_d()+
labs(title = paste0("How each source of ",pollutant," contributes to the inequality gradient"))
output
source("~/GitHub/PRAWNS/R/gradient_pie.R")
pie <- gradient_pie(pollutant = pollutant,
#The input path is the same as the output file for numbers
input_path=paste0(proc_tag,"/difference between deciles.csv"))
pie <- gradient_pie(pollutant = pollutant,
#The input path is the same as the output file for numbers
input_path=paste0(proc_tag,"/difference between deciles.csv"))
pie <- gradient_pie(pollutant = pollutant,
#The input path is the same as the output file for numbers
input_path=paste0(proc_tag,"/difference between deciles.csv"))
raw <- read.csv(input_path,
row.names=1,
check.names=FALSE)
#calculate and record the difference between the mean and median points and regression lines at deciles 1 and 10
numbers <- stat_wrangler(prawn_path = prawn_path,
)
write.csv(x=numbers,
file=paste0(proc_tag,"/difference between deciles.csv"))
pie <- gradient_pie(pollutant = pollutant,
#The input path is the same as the output file for numbers
input_path=paste0(proc_tag,"/difference between deciles.csv"))
write.csv(x=pie,
file=paste0(proc_tag,"/pie chart of source contributions to the gradient.csv"))
#extract the difference as a flat number
total_diff <-   raw %>%
filter(Emission_source=="Total") %>%
select(mean_flat_difference) %>%
as.numeric()
percentage_diffs <- tibble(Emission_source=raw$Emission_source,
delta_percent=raw$mean_flat_difference/total_diff)
output <- ggplot(data=raw %>% filter(Emission_source!="Total"),
aes(x="",
y=mean_flat_difference,
fill=fct_reorder(Emission_source,mean_flat_difference)))+
geom_col()+
coord_polar(theta="y")+
scale_fill_viridis_d()+
labs(title = paste0("How each source of ",pollutant," contributes to the inequality gradient"))
output
source("~/GitHub/PRAWNS/R/gradient_pie.R")
output <- ggplot(data=raw %>% filter(Emission_source!="Total"),
aes(x="",
y=mean_flat_difference,
fill=fct_reorder(Emission_source,mean_flat_difference)))+
geom_col()+
coord_polar(theta="y")+
scale_fill_viridis_d()+
labs(title = paste0("How each source of ",pollutant," contributes to the inequality gradient"))
output
pie <- gradient_pie(pollutant = pollutant,
#The input path is the same as the output file for numbers
input_path=paste0(proc_tag,"/difference between deciles.csv"))
write.csv(x=pie,
file=paste0(proc_tag,"/pie chart of source contributions to the gradient.csv"))
pie <- gradient_pie(pollutant = pollutant,
#The input path is the same as the output file for numbers
input_path=paste0(proc_tag,"/difference between deciles.csv"))
ggsave(filename= paste0(proc_tag,"/pie chart of how ",pollutant," sources contribute to the inequality gradient.png"),
plot=pie,
device="png")
library(PRAWNS)
setwd("~/Github/PRAWNS")
document()
rm(list = ls())
library(devtools)
library(roxygen2)
setwd("~/Github/PRAWNS")
document()
install.packages("~/Github/PRAWNS", repos=NULL, type="source")
library(PRAWNS)
setwd("~/GitHub/Data-analysis-with-PRAWNS-demo")
install.packages("~/Github/PRAWNS", repos=NULL, type="source")
library(PRAWNS)
detach("package:PRAWNS", unload = TRUE)
install.packages("~/Github/PRAWNS", repos=NULL, type="source")
library(devtools)
library(roxygen2)
setwd("~/Github/PRAWNS")
document()
library(PRAWNS)
detach("package:PRAWNS", unload = TRUE)
install.packages("~/Github/PRAWNS", repos=NULL, type="source")
library(PRAWNS)
#Load the package
library(PRAWNS)
#Set the working directory so the filepaths are correct
setwd("~/GitHub/Data-analysis-with-PRAWNS-demo")
#Load all the dependencies
Startup()
#Process PM2.5
bulk_processor(raster_path = "Data/pm2.5_rasters_2019",
shapefile_path = "Data/2011_LSOA_shapefile_20m_generalised",
data_folder = "Data/LSOA_statistics",
pollutant_data_name = "pm2_5",
year = 2019,
pollutant = "PM2.5",
iteration="0.4.3")
raster_path <-  "Data/pm2.5_rasters_2019"
shapefile_path <- "Data/2011_LSOA_shapefile_20m_generalised"
data_folder <- "Data/LSOA_statistics"
pollutant_data_name <- "pm2_5"
year <- 2019
pollutant <- "PM2.5"
iteration<-"0.4.3"
#Process PM2.5
bulk_processor(raster_path = raster_path,
shapefile_path = shapefile_path,
data_folder = data_folder,
pollutant_data_name = pollutant_data_name,
year = year,
pollutant = pollutant,
iteration=iteration)
#Process any city
city_summary(prawn_path = prawn_path,
shape_path = shapefile_path,
targets = city,
output_path= paste0("Outputs/",pollutant," emissions in ",city,".csv"),
pollutant=pollutant
)
proc_tag <- paste0(pollutant,"_emissions_in_",year,"_v",iteration)
prawn_path <- paste0(proc_tag,"/PRAWN.csv")
#Process any city
city_summary(prawn_path = prawn_path,
shape_path = shapefile_path,
targets = city,
output_path= paste0("Outputs/",pollutant," emissions in ",city,".csv"),
pollutant=pollutant
)
city <- "Coventry"
#Process any city
city_summary(prawn_path = prawn_path,
shape_path = shapefile_path,
targets = city,
output_path= paste0("Outputs/",pollutant," emissions in ",city,".csv"),
pollutant=pollutant
)
source("~/GitHub/PRAWNS/R/city_summary.R")
#Process any city
city_summary(prawn_path = prawn_path,
shape_path = shapefile_path,
targets = city,
output_path= paste0("Outputs/",pollutant," emissions in ",city,".csv"),
pollutant=pollutant
)
source("~/GitHub/PRAWNS/R/city_summary.R")
#Process any city
city_summary(prawn_path = prawn_path,
shape_path = shapefile_path,
targets = city,
output_path= paste0("Outputs/",pollutant," emissions in ",city,".csv"),
pollutant=pollutant
)
ggsave(filename= paste0("Outputs/",pollutant," emissions in ",city,".csv"),
plot=last_plot(),
device="png")
#Process any city
city_summary(prawn_path = prawn_path,
shape_path = shapefile_path,
targets = city,
output_path= paste0("Outputs/",pollutant," emissions in ",city,".png"),
pollutant=pollutant
)
ggsave(filename= paste0("Outputs/",pollutant," emissions in ",city,".png"),
plot=last_plot(),
device="png")
ggsave(filename= paste0("Outputs/",pollutant," emissions in ",city,".png"),
plot=last_plot(),
units = "mm",
height = 160,
width=160,
device="png")
ggsave(filename= paste0("Outputs/",pollutant," emissions in ",city,".png"),
plot=last_plot(),
units = "mm",
height = 16000,
width=16000,
device="png")
ggsave(filename= paste0("Outputs/",pollutant," emissions in ",city,".png"),
plot=last_plot(),
units = "mm",
height = 1600,
width=1600,
device="png")
ggsave(filename= paste0("Outputs/",pollutant," emissions in ",city,".png"),
plot=last_plot(),
units = "pixels",
height = 1600,
width=1600,
device="png")
ggsave(filename= paste0("Outputs/",pollutant," emissions in ",city,".png"),
plot=last_plot(),
units = "px",
height = 1600,
width=1600,
device="png")
ggsave(filename= paste0("Outputs/",pollutant," emissions in ",city,".png"),
plot=last_plot(),
units = "px",
height = 16000,
width=16000,
device="png")
ggsave(filename= paste0("Outputs/",pollutant," emissions in ",city,".png"),
plot=last_plot(),
units = "px",
height = 1600,
width=1600,
device="png")
ggsave(filename= paste0("Outputs/",pollutant," emissions in ",city,".png"),
plot=last_plot(),
units = "px",
height = 9000,
width=9000,
device="png")
ggsave(filename= paste0("Outputs/",pollutant," emissions in ",city,".png"),
plot=last_plot(),
units = "px",
height = 4500,
width=4500,
device="png")
city <- "Milton Keynes"
ggsave(filename= paste0("Outputs/",pollutant," emissions in ",city,".png"),
plot=last_plot(),
units = "px",
height = 4500,
width=4500,
device="png")
#Process any city
city_summary(prawn_path = prawn_path,
shape_path = shapefile_path,
targets = city,
output_path= paste0("Outputs/",pollutant," emissions in ",city,".png"),
pollutant=pollutant
)
ggsave(filename= paste0("Outputs/",pollutant," emissions in ",city,".png"),
plot=last_plot(),
units = "px",
height = 4500,
width=4500,
device="png")
library(devtools)
library(roxygen2)
setwd("~/Github/PRAWNS")
document()
install.packages("~/Github/PRAWNS", repos=NULL, type="source")
setwd("~/GitHub/Data-analysis-with-PRAWNS-demo")
install.packages("~/Github/PRAWNS", repos=NULL, type="source")
library(PRAWNS)
detach("package:PRAWNS", unload = TRUE)
detach("package:PRAWNS", unload = TRUE)
install.packages("~/Github/PRAWNS", repos=NULL, type="source")
#Load the package
library(PRAWNS)
#Set the working directory so the filepaths are correct
setwd("~/GitHub/Data-analysis-with-PRAWNS-demo")
#Load all the dependencies
Startup()
city <- "Bradford"
raster_path <-  "Data/pm2.5_rasters_2019"
shapefile_path <- "Data/2011_LSOA_shapefile_20m_generalised"
data_folder <- "Data/LSOA_statistics"
pollutant_data_name <- "pm2_5"
year <- 2019
pollutant <- "PM2.5"
iteration<-"0.4.3"
#Process PM2.5
bulk_processor(raster_path = raster_path,
shapefile_path = shapefile_path,
data_folder = data_folder,
pollutant_data_name = pollutant_data_name,
year = year,
pollutant = pollutant,
iteration=iteration)
proc_tag <- paste0(pollutant,"_emissions_in_",year,"_v",iteration)
prawn_path <- paste0(proc_tag,"/PRAWN.csv")
#Process any city
city_summary(prawn_path = prawn_path,
shape_path = shapefile_path,
targets = city,
output_path= paste0("Outputs/",pollutant," emissions in ",city,".png"),
pollutant=pollutant
)
ggsave(filename= paste0("Outputs/",pollutant," emissions in ",city,".png"),
plot=last_plot(),
units = "px",
height = 4500,
width=4500,
device="png")
source("~/GitHub/PRAWNS/R/create_prawns.R")
proc_tag <- paste0(pollutant,"_emissions_in_",year,"_v",iteration)
prawn_path <- paste0(proc_tag,"/rawPRAWN.csv")
#create the base prawn for this function, it will also be used by iterations 2 and 3 but filtered
create_prawns(
raster_path= raster_path,
shapefile_path = shapefile_path,
data_path= list.files(data_folder),
pollutant_data_name = pollutant_data_name,
year=year,
pollutant=pollutant,
output_path = prawn_path)
create_prawns(
raster_path= raster_path,
shapefile_path = shapefile_path,
data_path= list.files(data_folder),
pollutant_data_name = pollutant_data_name,
year=year,
pollutant=pollutant,
output_path = prawn_path,)
create_prawns(
raster_path= raster_path,
shapefile_path = shapefile_path,
data_path= list.files(data_folder),
pollutant_data_name = pollutant_data_name,
year=year,
pollutant=pollutant,
output_path = prawn_path,is_raw=TRUE)
source("~/GitHub/PRAWNS/R/create_prawns.R")
create_prawns(
raster_path= raster_path,
shapefile_path = shapefile_path,
data_path= list.files(data_folder),
pollutant_data_name = pollutant_data_name,
year=year,
pollutant=pollutant,
output_path = prawn_path,is_raw=TRUE)
source("~/GitHub/PRAWNS/R/city_summary.R")
#Process any city
city_summary(prawn_path = prawn_path,
shape_path = shapefile_path,
targets = city,
output_path= paste0("Outputs/",pollutant," emissions in ",city,".png"),
pollutant=pollutant
)
prawn_path <- paste0(proc_tag,"/PRAWN.csv")
#Process any city
city_summary(prawn_path = prawn_path,
shape_path = shapefile_path,
targets = city,
output_path= paste0("Outputs/",pollutant," emissions in ",city,".png"),
pollutant=pollutant
)
source("~/GitHub/PRAWNS/R/city_summary.R")
#Process any city
city_summary(prawn_path = prawn_path,
shape_path = shapefile_path,
targets = city,
output_path= paste0("Outputs/",pollutant," emissions in ",city,".png"),
pollutant=pollutant
)
#Process any city
city_summary(prawn_path = prawn_path,
shape_path = shapefile_path,
targets = city,
output_path= paste0("Outputs/",pollutant," emissions in ",city,".png"),
pollutant=pollutant
)
source("~/GitHub/PRAWNS/R/city_summary.R")
#Process any city
city_summary(prawn_path = prawn_path,
shape_path = shapefile_path,
targets = city,
output_path= paste0("Outputs/",pollutant," emissions in ",city,".png"),
pollutant=pollutant
)
source("~/GitHub/PRAWNS/R/city_summary.R")
#Process any city
city_summary(prawn_path = prawn_path,
shape_path = shapefile_path,
targets = city,
output_path= paste0("Outputs/",pollutant," emissions in ",city,".png"),
pollutant=pollutant
)
source("~/GitHub/PRAWNS/R/city_summary.R")
#Process any city
city_summary(prawn_path = prawn_path,
shape_path = shapefile_path,
targets = city,
output_path= paste0("Outputs/",pollutant," emissions in ",city,".png"),
pollutant=pollutant
)
source("~/GitHub/PRAWNS/R/city_summary.R")
#Process any city
city_summary(prawn_path = prawn_path,
shape_path = shapefile_path,
targets = city,
output_path= paste0("Outputs/",pollutant," emissions in ",city,".png"),
pollutant=pollutant
)
source("~/GitHub/PRAWNS/R/city_summary.R")
#Process any city
city_summary(prawn_path = prawn_path,
shape_path = shapefile_path,
targets = city,
output_path= paste0("Outputs/",pollutant," emissions in ",city,".png"),
pollutant=pollutant
)
source("~/GitHub/PRAWNS/R/city_summary.R")
#Process any city
city_summary(prawn_path = prawn_path,
shape_path = shapefile_path,
targets = city,
output_path= paste0("Outputs/",pollutant," emissions in ",city,".png"),
pollutant=pollutant
)
source("~/GitHub/PRAWNS/R/city_summary.R")
#Process any city
city_summary(prawn_path = prawn_path,
shape_path = shapefile_path,
targets = city,
output_path= paste0("Outputs/",pollutant," emissions in ",city,".png"),
pollutant=pollutant
)
source("~/GitHub/PRAWNS/R/city_summary.R")
#Process any city
city_summary(prawn_path = prawn_path,
shape_path = shapefile_path,
targets = city,
output_path= paste0("Outputs/",pollutant," emissions in ",city,".png"),
pollutant=pollutant
)
ggsave(filename= paste0("Outputs/",pollutant," emissions in ",city,".png"),
plot=last_plot(),
units = "px",
height = 4500,
width=4500,
device="png")
source("~/GitHub/PRAWNS/R/city_summary.R")
#Process any city
city_summary(prawn_path = prawn_path,
shape_path = shapefile_path,
targets = city,
output_path= paste0("Outputs/",pollutant," emissions in ",city,".png"),
pollutant=pollutant
)
ggsave(filename= paste0("Outputs/",pollutant," emissions in ",city,".png"),
plot=last_plot(),
units = "px",
height = 4500,
width=4500,
device="png")
