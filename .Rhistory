source("~/GitHub/Data-analysis-with-PRAWNS-demo/Scripts/recompile.R")
source("~/GitHub/Data-analysis-with-PRAWNS-demo/Scripts/recompile.R")
source("~/GitHub/Data-analysis-with-PRAWNS-demo/Scripts/recompile.R")
library(PRAWNS)
Startup()
?rast
?vect
Startup()
source("~/GitHub/PRAWNS/R/RUC_IMD.R")
#recreate the folder name
pollutant <- "NOx"
year <- 2020
iteration <- as.character(packageVersion("PRAWNS"))
prawn_path <- "NOx_emissions_in_2020_v0.10.3/Londonless/PRAWN.csv"
RUC_IMD(prawn_path,"NOx",2020)
setwd("~/GitHub/Data-analysis-with-PRAWNS-demo")
RUC_IMD(prawn_path,"NOx",2020)
source("~/GitHub/PRAWNS/R/RUC_IMD.R")
RUC_IMD(prawn_path,"NOx",2020)
#Read in the data with NA valuse changed to unclassified, raising red flags if necessary
active_stack <-read.csv(prawn_path) %>% mutate(across(RUC11,str_replace_all,c(
"Rural town and fringe in a sparse setting"="Rural town and fringe \nin a sparse setting",
"Rural village and dispersed in a sparse setting"= "Rural village and dispersed \nin a sparse setting",
"Urban city and town in a sparse setting"="Urban city and town \nin a sparse setting")))%>%
replace_na(list(RUC11="Unclassified"))
#Make the data long to enable grouping by source
temp <- active_stack %>%
tibble() %>%
dplyr::select(decile = IMD,
Emissions=Total,
Classification=RUC11) %>%
#group by the classification for graphing
group_by(Classification)
boxxy <- temp %>% group_by(IMD,RUC11) %>% summarise(q90=quantile(Total,c(0.90)),
q10=quantile(Total,c(0.10)),
q1=quantile(Total,c(0.25)),
q3=quantile(Total,c(0.75)),
med=quantile(Total,c(0.5))) %>%
pivot_longer(cols=c(q90,q10,q1,q3,med),values_to = "emissions")
boxxy <- temp %>% group_by(decile,classification) %>% summarise(q90=quantile(Emissions,c(0.90)),
q10=quantile(Emissions,c(0.10)),
q1=quantile(Emissions,c(0.25)),
q3=quantile(Emissions,c(0.75)),
med=quantile(Emissions,c(0.5))) %>%
pivot_longer(cols=c(q90,q10,q1,q3,med),values_to = "emissions")
boxxy <- temp %>% group_by(decile,Classification) %>% summarise(q90=quantile(Emissions,c(0.90)),
q10=quantile(Emissions,c(0.10)),
q1=quantile(Emissions,c(0.25)),
q3=quantile(Emissions,c(0.75)),
med=quantile(Emissions,c(0.5))) %>%
pivot_longer(cols=c(q90,q10,q1,q3,med),values_to = "emissions")
RUC_summary <- ggplot(temp)+
aes(x=decile,
y=Emissions)+
facet_wrap(~fct_reorder(Classification,Emissions,.desc=TRUE),scales = "free_y")
source("~/GitHub/PRAWNS/R/RUC_IMD.R")
RUC_IMD(prawn_path,"NOx",2020)
source("~/GitHub/PRAWNS/R/RUC_IMD.R")
RUC_IMD(prawn_path,"NOx",2020)
source("~/GitHub/PRAWNS/R/RUC_IMD.R")
RUC_IMD(prawn_path,"NOx",2020)
source("~/GitHub/PRAWNS/R/RUC_IMD.R")
RUC_IMD(prawn_path,"NOx",2020)
View(boxxy)
source("~/GitHub/PRAWNS/R/RUC_IMD.R")
RUC_IMD(prawn_path,"NOx",2020)
source("~/GitHub/PRAWNS/R/RUC_IMD.R")
source("~/GitHub/PRAWNS/R/RUC_IMD.R")
RUC_IMD(prawn_path,"NOx",2020)
source("~/GitHub/PRAWNS/R/RUC_IMD.R")
RUC_IMD(prawn_path,"NOx",2020)
source("~/GitHub/PRAWNS/R/RUC_IMD.R")
RUC_IMD(prawn_path,"NOx",2020)
source("~/GitHub/PRAWNS/R/RUC_IMD.R")
RUC_IMD(prawn_path,"NOx",2020)
source("~/GitHub/PRAWNS/R/RUC_IMD.R")
RUC_IMD(prawn_path,"NOx",2020)
source("~/GitHub/PRAWNS/R/RUC_IMD.R")
RUC_IMD(prawn_path,"NOx",2020)
source("~/GitHub/PRAWNS/R/RUC_IMD.R")
RUC_IMD(prawn_path,"NOx",2020)
source("~/GitHub/PRAWNS/R/RUC_IMD.R")
RUC_IMD(prawn_path,"NOx",2020)
RUC_IMD(prawn_path,"NOx",2020)[1]
source("~/GitHub/PRAWNS/R/RUC_IMD.R")
RUC_IMD(prawn_path,"NOx",2020)[1]
source("~/GitHub/PRAWNS/R/RUC_IMD.R")
RUC_IMD(prawn_path,"NOx",2020)[1]
source("~/GitHub/PRAWNS/R/RUC_IMD.R")
RUC_IMD(prawn_path,"NOx",2020)[1]
source("~/GitHub/PRAWNS/R/RUC_IMD.R")
RUC_IMD(prawn_path,"NOx",2020)[1]
source("~/GitHub/PRAWNS/R/RUC_IMD.R")
RUC_IMD(prawn_path,"NOx",2020)[1]
source("~/GitHub/PRAWNS/R/RUC_IMD.R")
RUC_IMD(prawn_path,"NOx",2020)[1]
source("~/GitHub/PRAWNS/R/faceted_sources.R")
source("~/GitHub/PRAWNS/R/RUC_IMD.R")
source("~/GitHub/PRAWNS/R/RUC_IMD.R")
RUC_IMD(prawn_path,"NOx",2020)[1]
source("~/GitHub/PRAWNS/R/RUC_IMD.R")
RUC_IMD(prawn_path,"NOx",2020)[1]
source("~/GitHub/PRAWNS/R/RUC_IMD.R")
RUC_IMD(prawn_path,"NOx",2020)[1]
source("~/GitHub/PRAWNS/R/RUC_IMD.R")
RUC_IMD(prawn_path,"NOx",2020)[1]
source("~/GitHub/PRAWNS/R/RUC_IMD.R")
RUC_IMD(prawn_path,"NOx",2020)[1]
source("~/GitHub/PRAWNS/R/RUC_IMD.R")
RUC_IMD(prawn_path,"NOx",2020)[1]
source("~/GitHub/PRAWNS/R/RUC_IMD.R")
RUC_IMD(prawn_path,"NOx",2020)[1]
source("~/GitHub/PRAWNS/R/avg_nox_histogram.R")
avg_nox_histogram(prawn_path)
source("~/GitHub/PRAWNS/R/avg_nox_histogram.R")
avg_nox_histogram(prawn_path)
source("~/GitHub/PRAWNS/R/avg_nox_histogram.R")
avg_nox_histogram(prawn_path)
source("~/GitHub/PRAWNS/R/avg_nox_histogram.R")
avg_nox_histogram(prawn_path)
source("~/GitHub/PRAWNS/R/avg_nox_histogram.R")
avg_nox_histogram(prawn_path)
source("~/GitHub/PRAWNS/R/avg_nox_histogram.R")
source("~/GitHub/Data-analysis-with-PRAWNS-demo/Scripts/recompile.R")
source("~/GitHub/Data-analysis-with-PRAWNS-demo/Scripts/6 10 22 compile.R")
proc_tag <- paste0(pollutant,"_emissions_in_",year,"_v",iteration,"/London_only")
prawn_path <- paste0(proc_tag,"/PRAWN.csv")
#Create the filtered data without London and save it at prawn_path
londonless_prawn <- read.csv(raw_path,
row.names=1,
check.names=FALSE) %>%
tibble() %>%
filter(TCITY15NM=="London") %>%
mutate(IMD=ntile(Index.of.Multiple.Deprivation..IMD..Rank..where.1.is.most.deprived.,10))
raw_path=prawn_path
#Create the filtered data without London and save it at prawn_path
londonless_prawn <- read.csv(raw_path,
row.names=1,
check.names=FALSE) %>%
tibble() %>%
filter(TCITY15NM=="London") %>%
mutate(IMD=ntile(Index.of.Multiple.Deprivation..IMD..Rank..where.1.is.most.deprived.,10))
london_window <- ggplot(data=londonless_prawn %>% pivot_longer(cols=c("Total","Road transport","Domestic combustion"),values_to = "Emissions",names_to="Source"),
aes(x=IMD,
y=Emissions,
colour=Source))+geom_smooth()
london_window
boxxy <- londonless_prawn %>% group_by(decile,Total) %>% summarise(q90=quantile(Emissions,c(0.90)),
q10=quantile(Emissions,c(0.10)),
q1=quantile(Emissions,c(0.25)),
q3=quantile(Emissions,c(0.75)),
med=quantile(Emissions,c(0.5))) %>%
pivot_longer(cols=c(q90,q10,q1,q3,med),values_to = "Emissions")
boxxy <- londonless_prawn %>% group_by(IMD,Total) %>% summarise(q90=quantile(Emissions,c(0.90)),
q10=quantile(Emissions,c(0.10)),
q1=quantile(Emissions,c(0.25)),
q3=quantile(Emissions,c(0.75)),
med=quantile(Emissions,c(0.5))) %>%
pivot_longer(cols=c(q90,q10,q1,q3,med),values_to = "Emissions")
boxxy <- londonless_prawn %>% group_by(IMD) %>% summarise(q90=quantile(Total,c(0.90)),
q10=quantile(Total,c(0.10)),
q1=quantile(Total,c(0.25)),
q3=quantile(Total,c(0.75)),
med=quantile(Total,c(0.5))) %>%
pivot_longer(cols=c(q90,q10,q1,q3,med),values_to = "Emissions")
london_window <- ggplot(data=londonless_prawn %>% pivot_longer(cols=c("Total","Road transport","Domestic combustion"),values_to = "Emissions",names_to="Source"),
aes(x=IMD,
y=Emissions,
colour=Source))+
geom_quantile(quantiles=0.5,
aes(colour="Median"),
size =1,
formula=y~x)+
geom_boxplot(data=boxxy)
london_window
london_window <- ggplot(data=londonless_prawn %>% pivot_longer(cols=c("Total","Road transport","Domestic combustion"),values_to = "Emissions",names_to="Source"),
aes(x=IMD,
y=Emissions,
colour=Source))+
geom_quantile(quantiles=0.5,
aes(colour="Median"),
size =1,
formula=y~x)+
geom_boxplot(data=boxxy)
london_window
data <- londonless_prawn %>% pivot_longer(cols=c("Total","Road transport","Domestic combustion"),values_to = "Emissions",names_to="Source")
data$Source
london_window <- ggplot(data = londonless_prawn %>% pivot_longer(cols=c("Total","Road transport","Domestic combustion"),values_to = "Emissions",names_to="Source"),
aes(x=IMD,
y=Emissions,
colour=Source))+
geom_quantile(quantiles=0.5,
aes(colour="Median"),
size =1,
formula=y~x)+
geom_boxplot(data=boxxy,aes(x=IMD,group=IMD,y=Emissions))
london_window
london_window <- ggplot(data = londonless_prawn %>% pivot_longer(cols=c("Total","Road transport","Domestic combustion"),values_to = "Emissions",names_to="Source")+
aes(x=IMD,
y=Emissions,
colour=Source))+
geom_quantile(quantiles=0.5,
size =1,
formula=y~x)+
geom_boxplot(data=boxxy,aes(x=IMD,group=IMD,y=Emissions))
london_window <- ggplot(data = londonless_prawn %>% pivot_longer(cols=c("Total","Road transport","Domestic combustion"),values_to = "Emissions",names_to="Source"))+
aes(x=IMD,
y=Emissions,
colour=Source)+
geom_quantile(quantiles=0.5,
size =1,
formula=y~x)+
geom_boxplot(data=boxxy,aes(x=IMD,group=IMD,y=Emissions))
london_window
londonless_long_prawn <- londonless_prawn %>% pivot_longer(cols=c("Total","Road transport","Domestic combustion"),
values_to = "Emissions",
names_to="Source")
london_window <- ggplot(data = londonless_long_prawn)+
aes(x=IMD,
y=Emissions,
colour=Source)+
geom_quantile(quantiles=0.5,
size =1,
formula=y~x)+
geom_boxplot(data=boxxy,aes(x=IMD,group=IMD,y=Emissions))
london_window
londonless_long_prawn$Source
london_window <- ggplot(data = londonless_long_prawn)+
aes(x=IMD,
y=Emissions)+
geom_quantile(quantiles=0.5,
size =1,
formula=y~x)+
geom_boxplot(data=boxxy,aes(x=IMD,group=IMD,y=Emissions))
london_window
london_window <- ggplot(data = londonless_long_prawn)+
aes(x=IMD,
y=Emissions)+
geom_quantile(quantiles=0.5,
size =1,
formula=y~x,
aes(colour=Source))+
geom_boxplot(data=boxxy,aes(x=IMD,group=IMD,y=Emissions))
london_window
